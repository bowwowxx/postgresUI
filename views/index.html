<html>
    <head>
         <link href="css/bootstrap.min.css" rel="stylesheet">
         <link rel="icon"  type="image/icon"  href="Node.ico" />
    </head>
    <body ng-app="postgreSQL">
        <div class="container" style="margin-top:20px;"  ng-controller="postgreSQLCtrl">
            <div class="row clearfix">
                <div class="col-md-12 column">
                    <div class="jumbotron">
                        <h1>
                            MetaData
                        </h1>
                        <p>
                            This application demonstrates database operations using PostgreSQL as a database, as javascript based MVC.
                            <br /> <br />
                            <a class="pull-right" href=""> Bowwow </a>
                        </p>

                    </div>
                </div>
            </div>

            <div class="row clearfix" style="margin-bottom:10px;">
                <div class="controls form-inline form-group">
                    <div class="col-md-2">
                        <input id="title" name="title"  placeholder="title" ng-model="title"
                               type="text" class="form-control input-small">
                    </div>

                    <div class="col-md-2">
                        <input id="len" name="len"  placeholder="len" ng-model="len"
                               type="text" class="form-control input-small">
                    </div>

                    <div class="col-md-2">
                        <input id="lang" name="lang"  placeholder="lang" ng-model="lang"
                               type="text" class="form-control input-small">
                    </div>

                    <div class="col-md-2">
                        <input id="artist" name="artist"  placeholder="artist" ng-model="artist"
                               type="text" class="form-control input-small">
                    </div>
                    <div class="col-md-2">
                        <input id="artist_keywords" name="artist_keywords"  placeholder="artist_keywords" ng-model="artist_keywords"
                               type="text" class="form-control input-small">
                    </div>
                    <div class="col-md-2">
                        <input id="gender" name="gender"  placeholder="gender" ng-model="gender"
                               type="text" class="form-control input-small">
                    </div>
                    <div class="col-md-2">
                        <input id="country" name="country"  placeholder="country" ng-model="country"
                               type="text" class="form-control input-small">
                    </div>
                    <div class="col-md-2">
                        <input id="genre" name="genre"  placeholder="genre" ng-model="genre"
                               type="text" class="form-control input-small">
                    </div>
                    <div class="col-md-2">
                        <input id="subtitle" name="subtitle"  placeholder="subtitle" ng-model="subtitle"
                               type="text" class="form-control input-small">
                    </div>
                    <div class="col-md-2">
                        <input id="release_date" name="release_date"  placeholder="release_date" ng-model="release_date"
                               type="text" class="form-control input-small">
                    </div>
                    <div class="col-md-2">
                        <input id="add_date" name="add_date"  placeholder="add_date" ng-model="add_date"
                               type="text" class="form-control input-small">
                    </div>
                    <div class="col-md-2">
                        <input id="artist_pic_url" name="artist_pic_url"  placeholder="artist_pic_url" ng-model="artist_pic_url"
                               type="text" class="form-control input-small">
                    </div>
                    <div class="col-md-2">
                        <input id="lyrics" name="lyrics"  placeholder="lyrics" ng-model="lyrics"
                               type="text" class="form-control input-small">
                    </div>
                    <div class="col-md-2">
                        <input id="composer" name="composer"  placeholder="composer" ng-model="composer"
                               type="text" class="form-control input-small">
                    </div>
                    <div class="col-md-2">
                        <input id="rank" name="rank"  placeholder="rank" ng-model="rank"
                               type="text" class="form-control input-small">
                    </div>
                    <div class="col-md-2">
                        <input id="propoties" name="propoties"  placeholder="propoties" ng-model="propoties"
                               type="text" class="form-control input-small">
                    </div>

                    <div class="col-md-2">
                        <button ng-click="addRecord()" id="btnAdd" name="btnAdd" class="btn btn-danger">Add</button>
                    </div>

                </div>
            </div>

            <div class="row clearfix">
                <table class="table table-bordered table-hover table-condensed">
                    <thead>
                        <tr>
                            <th>  Id    </th>
                            <th>  Title </th>
                            <th>  Len   </th>
                            <th>  Lang </th>
                            <th>  Artist </th>
                            <th>  Artist_keywords  </th>
                            <th>  Gender </th>
                            <th>  Country </th>
                            <th>  Genre </th>
                            <th>  Subtitle </th>
                            <th>  Release_date  </th>
                            <th>  Add_date </th>
                            <th>  Artist_pic_url </th>
                            <th>  Lyrics </th>
                            <th>  Composer </th>
                            <th>  Rank  </th>
                            <th>  Propoties </th>
                            <th>   </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="item in dataset">
                            <td> {{item.id}} </td>
                            <td> {{item.title}} </td>
                            <td> {{item.len}} </td>
                            <td> {{item.lang}} </td>
                            <td> {{item.artist}} </td>
                            <td> {{item.artist_keywords}} </td>
                            <td> {{item.gender}} </td>
                            <td> {{item.country}} </td>
                            <td> {{item.genre}} </td>
                            <td> {{item.subtitle}} </td>
                            <td> {{item.release_date}} </td>
                            <td> {{item.add_date}} </td>
                            <td> {{item.artist_pic_url}} </td>
                            <td> {{item.lyrics}} </td>
                            <td> {{item.composer}} </td>
                            <td> {{item.rank}} </td>
                            <td> {{item.propoties}} </td>
                            <td> <span title="delete this record" class="glyphicon glyphicon-trash text-danger" style="cursor:pointer" ng-click="delRecord(item.id)"></span> </td>
                        </tr>
                    </tbody>
                </table>

            </div>
        </div>

        <script src="lib/angular.min.js"></script>
        <script>

            var myApp = angular.module('postgreSQL',[ ]);

            myApp.controller('postgreSQLCtrl', ['$scope' ,'$http',  function($scope,$http) {
                $scope.val1 = 'This is temp Val' ;
                $scope.title = '';
                $scope.len = '';
                $scope.lang = '';
                $scope.artist = '' ;
                $scope.artist_keywords = '';
                $scope.gender = '';
                $scope.country = '';
                $scope.genre = '' ;
                $scope.subtitle = '';
                $scope.release_date = '';
                $scope.add_date = '';
                $scope.artist_pic_url = '' ;
                $scope.lyrics = '';
                $scope.composer = '';
                $scope.rank = '' ;
                $scope.propoties = '' ;

                $scope.getAllRec = function(){
                     $http({method: 'GET', url: '/db/readRecords'}).
                        success(function(data, status) {
                              $scope.dataset = data;
                        }).
                        error(function(data, status) {
                          $scope.dataset = data || "Request failed ";
                      });
                }


                $scope.addRecord = function(){
                  $http({method: 'GET', url: '/db/addRecord?title='+$scope.title+'&len='+
                         $scope.len+'&lang='+$scope.lang+'&artist='+$scope.artist+'&artist_keywords='+
                         $scope.artist_keywords+'&gender='+$scope.gender+'&country='+$scope.country+'&genre='+
                         $scope.genre+'&genre='+$scope.genre+'&subtitle='+$scope.subtitle+'&release_date='+
                         $scope.release_date+'&add_date='+$scope.add_date+'&artist_pic_url='+$scope.artist_pic_url+'&lyrics='+
                         $scope.lyrics+'&composer='+$scope.composer+'&rank='+$scope.rank+'&propoties='+
                         $scope.propoties}).
                         
                        success(function(data, status) {
                                alert('Record Added');
                                $scope.getAllRec();
                        });
                }

                $scope.delRecord = function(recId){
                    console.log(recId);
                    if(confirm('Are you sure you want to delete this record ? '))
                    {
                        $http({method: 'GET', url: '/db/delRecord?id='+recId}).
                            success(function(data, status) {
                                    $scope.getAllRec();
                            });
                    }
                }

                $scope.getAllRec();

            }]);

        </script>

    </body>

</html>
